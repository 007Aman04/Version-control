This is a second version of third chapter.
